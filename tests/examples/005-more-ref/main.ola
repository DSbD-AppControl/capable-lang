func printLn(str:String) -> Unit
{
  print(str)
; print(toString('\n'))

}

func factory(b : Bool) -> &String
{
  printLn("Start of Function")

; var msg = "Example 5"
  in { printLn(!msg)
     ; if b
       {
         set msg to "New Message"
       ; msg
       } else
       {
         msg
       }
     }
}

func bump(p : &String) -> Unit
{
  set p to "Bump!"
}

main()
{

  local b = factory(true)
  in { local c = factory(false)
       in { printLn(!c)
          ; printLn(!b)

          ; bump(b)
          ; printLn(!b)
          }

     }
}
